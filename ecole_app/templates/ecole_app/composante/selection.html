{% extends 'ecole_app/base_simple.html' %}
{% load static %}

{% block title %}Sélection de Composante{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow">
                <div class="card-header bg-primary text-white text-center">
                    <h3><i class="fas fa-school me-2"></i>Sélection de Composante</h3>
                    <p class="mb-0">Choisissez la composante de l'école à gérer</p>
                </div>
                <div class="card-body">
                    {% if composantes %}
                        <form method="post">
                            {% csrf_token %}
                            <div class="row">
    {% for composante in composantes %}
    <div class="col-md-6 mb-3">
        <div class="card mb-4 shadow-sm composante-card" onclick="selectComposante({{ composante.id }})" id="card-{{ composante.id }}">
            <div class="card-body text-center">
                <i class="fas fa-graduation-cap fa-3x text-primary mb-3"></i>
                <h5 class="card-title">{{ composante.nom }}</h5>
                {% if composante.description %}
                    <p class="card-text text-muted">{{ composante.description }}</p>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>
<input type="hidden" name="composante_id" id="composante_id_input" value="">
                            </div>
                            
                            <div class="text-center mt-4">
                                <button type="submit" class="btn btn-primary btn-lg" id="btn-continuer" disabled>
    <i class="fas fa-arrow-right me-2"></i>Continuer
</button>
                            </div>
                        </form>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <a href="{% url 'gestion_composantes' %}" class="btn btn-outline-secondary">
                                <i class="fas fa-cog me-2"></i>Gérer les composantes
                            </a>
                        </div>
                    {% else %}
                        <div class="text-center">
                            <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
                            <h4>Aucune composante active</h4>
                            <p class="text-muted">Il n'y a actuellement aucune composante active dans le système.</p>
                            <a href="{% url 'gestion_composantes' %}" class="btn btn-primary">
                                <i class="fas fa-plus me-2"></i>Créer une composante
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.composante-card {
    transition: all 0.3s ease;
    border: 2px solid transparent;
}

.composante-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    border-color: #007bff;
}

.composante-card.selected {
    border-color: #007bff;
    background-color: #f8f9ff;
}
</style>

<script>
function selectComposante(id) {
    // Désélectionner toutes les cartes
    document.querySelectorAll('.composante-card').forEach(card => {
        card.classList.remove('selected');
    });
    // Sélectionner la carte cliquée
    var card = document.getElementById('card-' + id);
    if(card) card.classList.add('selected');
    // Mettre à jour l'input caché
    document.getElementById('composante_id_input').value = id;
    // Activer le bouton continuer
    document.getElementById('btn-continuer').disabled = false;
}
</script>
{% endblock %}
